<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ—¥å ±</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4285f4">
    <link rel="apple-touch-icon" href="icon.png">
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“ æ—¥å ±</h1>
        </header>

        <main>
            <form id="nippouForm" class="nippou-form">
                <div class="form-group">
    <label for="name">ãŠåå‰ <span class="required">*</span></label>
    <select id="name" name="name" required>
        <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
        <option value="é–¢">é–¢ã€€</option>
        <option value="å±±å²¸">å±±å²¸ã€€</option>
        <option value="é»’å·">é»’å·ã€€</option>
        <option value="ãã¿ã•ã‚“">å‰ç”°ã€€</option>
        <option value="ä¸‹ç¾½">ä¸‹ç¾½ </option>
        <option value="è‹¥ç‹­">è‹¥ç‹­ </option>
        <option value="å±±å´">å±±å´ </option>
        <option value="å‰ç”°åºƒå¸">å‰ç”°</option>
        <option value="åŠ è—¤">åŠ è—¤ </option>
        <option value="å‰ç”°">å‰ç”° </option>
        <option value="ã‚«ã‚¤ãƒœã‚¦">é™½ </option>
        <option value="æ™ºä¹‹">ä¹‹ </option>
        <option value="æ™ºå­">å­ </option>
    </select>                   
</div>

                <div class="form-group">
                    <label for="worksite">ä½œæ¥­ç¾å ´ <span class="required">*</span></label>
                    <input type="text" id="worksite" name="worksite" placeholder="ä½œæ¥­ç¾å ´åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„" required>
                </div>

                <div class="form-group">
                    <label for="date">æ—¥ä»˜ <span class="required">*</span></label>
                    <input type="date" id="date" name="date" required>
                </div>

                <div class="time-group">
                    <div class="form-group">
                        <label for="startTime">é–‹å§‹æ™‚åˆ» <span class="required">*</span></label>
                        <input type="time" id="startTime" name="startTime" value="08:00" required>
                    </div>
                    <div class="form-group">
                        <label for="endTime">çµ‚äº†æ™‚åˆ» <span class="required">*</span></label>
                        <input type="time" id="endTime" name="endTime" value="17:00" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="workContent">æ¥­å‹™å†…å®¹ <span class="required">*</span></label>
                    <textarea id="workContent" name="workContent" rows="6" placeholder="ä»Šæ—¥ã®æ¥­å‹™å†…å®¹ã‚’è¨˜å…¥ã—ã¦ãã ã•ã„" required></textarea>
                </div>

                <div class="form-group">
                    <label for="memo">ãƒ¡ãƒ¢ï¼ˆä»»æ„ï¼‰</label>
                    <textarea id="memo" name="memo" rows="3" placeholder="æ°—ã¥ã„ãŸã“ã¨ã‚„æ˜æ—¥ã®äºˆå®šãªã©"></textarea>
                </div>

                <button type="submit" class="submit-btn">
                    <span class="btn-text">ğŸ“¤ æ—¥å ±ã‚’é€ä¿¡</span>
                </button>
            </form>

            <div id="message" class="message"></div>
<!-- ===== æ²ç¤ºæ¿ãƒ–ãƒ­ãƒƒã‚¯ã‚’è¿½åŠ  ===== -->
      <section id="board" style="margin-top:3rem;">
        <h2 style="border-left:5px solid #388e3c;padding-left:0.5em;">ğŸ’¬ æ²ç¤ºæ¿</h2>

        <!-- æŠ•ç¨¿ãƒ•ã‚©ãƒ¼ãƒ  -->
        <form id="postForm" style="margin-bottom:1.5rem;">
          <select id="category">
            <option value="ãŠçŸ¥ã‚‰ã›">ğŸ“¢ ãŠçŸ¥ã‚‰ã›</option>
            <option value="é€£çµ¡äº‹é …">ğŸ“ é€£çµ¡äº‹é …</option>
            <option value="ãã®ä»–">ğŸ’¬ ãã®ä»–</option>
          </select>
          <input id="poster" type="text" placeholder="æŠ•ç¨¿è€…å" required>
          <textarea id="content" rows="3" placeholder="æŠ•ç¨¿å†…å®¹" required></textarea>
          <button type="submit">æŠ•ç¨¿ã™ã‚‹</button>
        </form>

        <!-- æŠ•ç¨¿ä¸€è¦§ -->
        <div id="posts"></div>
      </section>
        </main>
    </div>
<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('./service-worker.js').then(registration => {
      if (registration.waiting) {
        registration.waiting.postMessage({ type: 'SKIP_WAITING' });
        window.location.reload(); // â† å†èª­ã¿è¾¼ã¿
      }
      registration.addEventListener('updatefound', () => {
        const newWorker = registration.installing;
        newWorker.addEventListener('statechange', () => {
          if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
            newWorker.postMessage({ type: 'SKIP_WAITING' });
            window.location.reload(); // â† å†èª­ã¿è¾¼ã¿
          }
        });
      });
    });
  });
}
</script>
    <script src="script.js?v=20250625"></script>
 <!-- ===== Firebase æ²ç¤ºæ¿ç”¨ ===== -->
  <script type="module">
    /* â–¼ Firebase SDK èª­ã¿è¾¼ã¿ */
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js";
    import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyABfhsh7rmgVd9wsXHKIHmxsV7uo8KRMzY",
  authDomain: "goodboard-3f9c3.firebaseapp.com",
  databaseURL: "https://goodboard-3f9c3-default-rtdb.firebaseio.com",
  projectId: "goodboard-3f9c3",
  storageBucket: "goodboard-3f9c3.appspot.com",
  messagingSenderId: "287644765073",
  appId: "1:287644765073:web:41795c1b85e929a1126830"
};

const app = initializeApp(firebaseConfig);
const db  = getDatabase(app);
const postsRef = ref(db, "posts");

    /* â–¼ æŠ•ç¨¿ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ */
    document.getElementById("postForm").addEventListener("submit", e => {
      e.preventDefault();
      
 // ã“ã“ã§è¦ç´ ã‚’å–å¾—ã—ã¦å¤‰æ•°ã«å…¥ã‚Œã‚‹
  const categoryEl = document.getElementById("category");
  const posterEl   = document.getElementById("poster");
  const contentEl  = document.getElementById("content");
      const data = {
        category : categoryEl.value,
        poster   : posterEl.value,
        content  : contentEl.value,
        ts       : Date.now()
      };
      push(postsRef, data);   // Firebase ã«ä¿å­˜
      e.target.reset();
    });

    /* â–¼ è¿½åŠ ã•ã‚ŒãŸæŠ•ç¨¿ã‚’ç”»é¢ã«æç”» */
    const postsDiv = document.getElementById("posts");
    onChildAdded(postsRef, snap => {
      const d = snap.val();
      const div = document.createElement("div");
      div.className = "post-item";
      div.innerHTML = `
        <strong>${d.category} | ${d.poster}</strong>
        <p>${d.content}</p>
        <time>${new Date(d.ts).toLocaleString("ja-JP")}</time>
        <hr>
      `;
      postsDiv.prepend(div);
    });
  </script>

</body>
</html>
